<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link href="main.css" rel="stylesheet">
  </head>
  <body>
    <script>
      function prettyifyDate(date) {
        var month = date.getMonth().toString();
        var day = date.getDate().toString();
        var year = date.getFullYear().toString();
        var hours = date.getHours().toString();
        var minutes = date.getMinutes().toString();
        return month + '/' + day + ' ' + year + ' at ' + hours + ':' + minutes; 
      }

      function jQueryfyTweet(tweet) {
          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message + ' ' + prettyifyDate(tweet.created_at));
          return $tweet;
      }

      $(document).ready(function(){
        var $body = $('body');
        $body.html(''); // sets the html of the body to an empty string
        
        var index = streams.home.length - 1; //setting up movement in reverse chronological order
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = jQueryfyTweet(tweet);
          $tweet.appendTo($body);
          index -= 1;
        }
      
        var storedLatestTweet = streams.home[streams.home.length - 1]
        var checkForNewTweet = function() {
          var currentLatestTweet = streams.home[streams.home.length - 1]
          if (storedLatestTweet != currentLatestTweet){
            $currentLatestTweet = jQueryfyTweet(currentLatestTweet);
            $currentLatestTweet.prependTo($body);
            storedLatestTweet = currentLatestTweet;
          }
          setTimeout(checkForNewTweet,100);
        }
        setTimeout(checkForNewTweet,100); 
        // I should have just called the function to add the new tweet  in the other file 
        //every time a new tweet is generated; not sure why I didn't just do that
      })
    </script>
  </body>
</html>
